},
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("*", "**", "***", "-"), type = "points", labels = c("< 0.05", "<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
columns_annotation <- c()
for(value in p_values_columns){
if(value < 0.001){
columns_annotation <- c(columns_annotation, "***")
}
else if(value < 0.01){
columns_annotation <- c(columns_annotation, "**")
}
else if(value < 0.05){
columns_annotation <- c(columns_annotation, "*")
}
else {
columns_annotation <- c(columns_annotation, "")
}
}
row_annotation <- c()
for(value in p_values_rows){
if(value < 0.001){
row_annotation <- c(row_annotation, "***")
}
else if(value < 0.01){
row_annotation <- c(row_annotation, "**")
}
else if(value < 0.05){
row_annotation <- c(row_annotation, "*")
}
else {
row_annotation <- c(row_annotation, "")
}
}
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE),
annotation_label = c("Cluster size"))
ha_row = rowAnnotation(foo = anno_text(x = row_annotation, which = "row", show_name= TRUE),
annotation_label = c("Sample"))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y)
}
},
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE),
annotation_label = c("Cluster size"))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE),
annotation_label = c("Cluster size"))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE),
annotation_label = c("Cluster size"))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE),
annotation_label = c("Cluster size"))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE),
annotation_label = c("Cluster size"))
ha_row = rowAnnotation(foo = anno_text(x = row_annotation, which = "row", show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Sample"))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y)
}
},
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Cluster size"))
ha_row = rowAnnotation(foo = anno_text(x = row_annotation, which = "row", show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Sample"))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y)
}
},
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
},
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
},
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 8),
columns_names_gp = gpar(fontsize = 8),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 8),
columns_names_gp = gpar(fontsize = 8),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
?Heatmap
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 3),
columns_names_gp = gpar(fontsize = 3),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 1),
columns_names_gp = gpar(fontsize = 1),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 1),
columns_names_gp = gpar(fontsize = 1),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 5),
columns_names_gp = gpar(fontsize = 5),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
?Heatmap
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 5),
column_names_gp = gpar(fontsize = 5),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 8),
column_names_gp = gpar(fontsize = 8),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Cluster size", gpar(fontsize = 5)))
ha_row = rowAnnotation(foo = anno_text(x = row_annotation, which = "row", show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Sample"))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 8),
column_names_gp = gpar(fontsize = 8),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Cluster size", gp = gpar(fontsize = 5)))
ha_row = rowAnnotation(foo = anno_text(x = row_annotation, which = "row", show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Sample"))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 8),
column_names_gp = gpar(fontsize = 8),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Cluster size"))
ha_col <- HeatmapAnnotation(foo = anno_text(x = columns_annotation, location = 1, rot = 45, show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Cluster size"), annotation_name_gp= gpar(fontsize = 10))
ha_row = rowAnnotation(foo = anno_text(x = row_annotation, which = "row", show_name= TRUE, gp = gpar(fontsize = 8)),
annotation_label = c("Sample"), annotation_name_gp= gpar(fontsize = 10))
ht <- Heatmap(frequency_table, cell_fun = function(j, i, x, y, w, h, fill) {
if(!is.na(p_values_table[i, j])){
if(p_values_table[i, j] < 0.001) {
grid.text("***", x, y, gp = gpar(fontsize = 8) )
} else if(p_values_table[i, j] < 0.01) {
grid.text("**", x, y, gp = gpar(fontsize = 8))
}
else if (p_values_table[i, j] < 0.05) {
grid.text("*", x, y, gp = gpar(fontsize = 8))
}
}
else if(is.na(p_values_table[i, j])) {
grid.text("-", x, y, gp = gpar(fontsize = 8))
}
},
row_names_gp = gpar(fontsize = 8),
column_names_gp = gpar(fontsize = 8),
cluster_rows = FALSE,
cluster_columns = FALSE,
col = col_fun,
heatmap_legend_param = list(title = "% mono",
at = c(0, 0.5, 1), labels = c("0", "50", "100")),
top_annotation = ha_col,
left_annotation = ha_row
)
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
?Legend
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"), labels_gp = gpar(fontsize = 10))
draw(ht, annotation_legend_list = list(lgd_sig))
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"), labels_gp = gpar(fontsize = 8))
draw(ht, annotation_legend_list = list(lgd_sig))
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"))
draw(ht, annotation_legend_list = list(lgd_sig))
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"), legend_gp = gpar(fontsize = 10))
draw(ht, annotation_legend_list = list(lgd_sig))
lgd_sig = Legend(pch = c("**", "***", "-"), type = "points", labels = c("<0.01", "<0.001", "NA"), legend_gp = gpar(fontsize = 8))
draw(ht, annotation_legend_list = list(lgd_sig))
all_pvalues
fisher(unlist(all_pvalues))
?ComplexHeatmap
?Heatmap
?Legend
